<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>BatchEnsemble · DeepUncertainty.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/flux.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DeepUncertainty.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../initializers/">Trainable Distributions</a></li><li><a class="tocitem" href="../mclayers/">MC Dropout</a></li><li class="is-active"><a class="tocitem" href>BatchEnsemble</a></li><li><a class="tocitem" href="../bayesianbe/">Bayesian BatchEnsemble</a></li><li><a class="tocitem" href="../variational/">Variational Inference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>BatchEnsemble</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>BatchEnsemble</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/aced-differentiate/DeepUncertainty.jl/blob/master/docs/src/layers/batchensemble.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="BatchEnsemble-layers"><a class="docs-heading-anchor" href="#BatchEnsemble-layers">BatchEnsemble layers</a><a id="BatchEnsemble-layers-1"></a><a class="docs-heading-anchor-permalink" href="#BatchEnsemble-layers" title="Permalink"></a></h1><ul><li><a href="#DeepUncertainty.ConvBE"><code>DeepUncertainty.ConvBE</code></a></li><li><a href="#DeepUncertainty.DenseBE"><code>DeepUncertainty.DenseBE</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="DeepUncertainty.DenseBE" href="#DeepUncertainty.DenseBE"><code>DeepUncertainty.DenseBE</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DenseBE(in, out, rank, 
        ensemble_size, 
        σ=identity; 
        bias=true,
        init=glorot_normal, 
        alpha_init=glorot_normal, 
        gamma_init=glorot_normal)
DenseBE(layer, alpha, gamma, ensemble_bias, ensemble_act, rank)</code></pre><p>Creates a dense BatchEnsemble layer. Batch ensemble is a memory efficient alternative  for deep ensembles. In deep ensembles, if the ensemble size is N, N different models  are trained, making the time and memory complexity O(N * complexity of one network).  BatchEnsemble generates weight matrices for each member in the ensemble using a  couple of rank 1 vectors R (alpha), S (gamma), RS&#39; and multiplying the result with  weight matrix W element wise. We also call R and S as fast weights. </p><p>Reference - https://arxiv.org/abs/2002.06715 </p><p>During both training and testing, we repeat the samples along the batch dimension  N times, where N is the ensemble_size. For example, if each mini batch has 10 samples  and our ensemble size is 4, then the actual input to the layer has 40 samples.  The output of the layer has 40 samples as well, and each 10 samples can be considered  as the output of an esnemble member. </p><p><strong>Fields</strong></p><ul><li><code>layer</code>: The dense layer which transforms the pertubed input to output </li><li><code>alpha</code>: The first Fast weight of size (in<em>dim, ensemble</em>size)</li><li><code>gamma</code>: The second Fast weight of size (out<em>dim, ensemble</em>size)</li><li><code>ensemble_bias</code>: Bias added to the ensemble output, separate from dense layer bias </li><li><code>ensemble_act</code>: The activation function to be applied on ensemble output </li><li><code>rank</code>: Rank of the fast weights (rank &gt; 1 doesn&#39;t work on GPU for now)</li></ul><p><strong>Arguments</strong></p><ul><li><code>in::Integer</code>: Input dimension of features </li><li><code>out::Integer</code>: Output dimension of features </li><li><code>rank::Integer</code>: Rank of the fast weights </li><li><code>ensemble_size::Integer</code>: Number of models in the ensemble </li><li><code>σ::F=identity</code>: Activation of the dense layer, defaults to identity</li><li><code>init=glorot_normal</code>: Initialization function, defaults to glorot_normal </li><li><code>alpha_init=glorot_normal</code>: Initialization function for the alpha fast weight,                       defaults to glorot_normal </li><li><code>gamma_init=glorot_normal</code>: Initialization function for the gamma fast weight,                        defaults to glorot_normal </li><li><code>bias::Bool=true</code>: Toggle the usage of bias in the dense layer </li><li><code>ensemble_bias::Bool=true</code>: Toggle the usage of ensemble bias </li><li><code>ensemble_act::F=identity</code>: Activation function for enseble outputs </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aced-differentiate/DeepUncertainty.jl/blob/7ce0067b3dd02ea56829d3cefb8b453c59c1f085/src/layers/BatchEnsemble/dense.jl#L1-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DeepUncertainty.ConvBE" href="#DeepUncertainty.ConvBE"><code>DeepUncertainty.ConvBE</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ConvBE(filter, in =&gt; out, rank, 
        ensemble_size, σ = identity;
        stride = 1, pad = 0, dilation = 1, 
        groups = 1, [bias, weight, init])
ConvBE(layer, alpha, gamma, ensemble_bias, ensemble_act, rank)</code></pre><p>Creates a conv BatchEnsemble layer. Batch ensemble is a memory efficient alternative  for deep ensembles. In deep ensembles, if the ensemble size is N, N different models  are trained, making the time and memory complexity O(N * complexity of one network).  BatchEnsemble generates weight matrices for each member in the ensemble using a  couple of rank 1 vectors R (alpha), S (gamma), RS&#39; and multiplying the result with  weight matrix W element wise. We also call R and S as fast weights. </p><p>Reference - https://arxiv.org/abs/2002.06715 </p><p>During both training and testing, we repeat the samples along the batch dimension  N times, where N is the ensemble_size. For example, if each mini batch has 10 samples  and our ensemble size is 4, then the actual input to the layer has 40 samples.  The output of the layer has 40 samples as well, and each 10 samples can be considered  as the output of an esnemble member. </p><p><strong>Fields</strong></p><ul><li><code>layer</code>: The dense layer which transforms the pertubed input to output </li><li><code>alpha</code>: The first Fast weight of size (in<em>dim, ensemble</em>size)</li><li><code>gamma</code>: The second Fast weight of size (out<em>dim, ensemble</em>size)</li><li><code>ensemble_bias</code>: Bias added to the ensemble output, separate from dense layer bias </li><li><code>ensemble_act</code>: The activation function to be applied on ensemble output </li><li><code>rank</code>: Rank of the fast weights (rank &gt; 1 doesn&#39;t work on GPU for now)</li></ul><p><strong>Arguments</strong></p><ul><li><code>filter::NTuple{N,Integer}</code>: Kernel dimensions, eg, (5, 5) </li><li><code>ch::Pair{&lt;:Integer,&lt;:Integer}</code>: Input channels =&gt; output channels </li><li><code>rank::Integer</code>: Rank of the fast weights </li><li><code>ensemble_size::Integer</code>: Number of models in the ensemble </li><li><code>σ::F=identity</code>: Activation of the dense layer, defaults to identity</li><li><code>init=glorot_normal</code>: Initialization function, defaults to glorot_normal </li><li><code>alpha_init=glorot_normal</code>: Initialization function for the alpha fast weight,                           defaults to glorot_normal </li><li><code>gamma_init=glorot_normal</code>: Initialization function for the gamma fast weight,                            defaults to glorot_normal </li><li><code>bias::Bool=true</code>: Toggle the usage of bias in the dense layer </li><li><code>ensemble_bias::Bool=true</code>: Toggle the usage of ensemble bias </li><li><code>ensemble_act::F=identity</code>: Activation function for enseble outputs </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/aced-differentiate/DeepUncertainty.jl/blob/7ce0067b3dd02ea56829d3cefb8b453c59c1f085/src/layers/BatchEnsemble/conv.jl#L1-L45">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mclayers/">« MC Dropout</a><a class="docs-footer-nextpage" href="../bayesianbe/">Bayesian BatchEnsemble »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Sunday 17 October 2021 10:07">Sunday 17 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
